deployments: {}
resources:
  rabbitmq:
    replicas: 3
    memory: 512Mi
    cpu: 100m
    disk: 1Gi
    config:
      additionalConfig: |
        log.console.level = info
        vm_memory_high_watermark.relative = 0.7
        cluster_formation.k8s.address_type = hostname
        cluster_formation.k8s.hostname_suffix = .huginn-nodes.default
  redis:
    sentinels: 3
    replicas: 2
    memory: 100Mi # must use Gi or Mi format
    cpu: 100m
    disk: 500Mi
  postgres:
    replicas: 2
    memory: 1Gi
    cpu: 100m
    disk: 10Gi
    config:
      max_connections: "40"
      shared_buffers: 256MB
      effective_cache_size: 768MB
      maintenance_work_mem: 64MB
      checkpoint_completion_target: "0.9"
      wal_buffers: 7864kB
      default_statistics_target: "100"
      random_page_cost: "1.1"
      effective_io_concurrency: "200"
      work_mem: 3276kB
      min_wal_size: 1GB
      max_wal_size: 4GB
      pg_stat_statements.max: "10000"
      pg_stat_statements.track: top
envFrom: []
env:
  - { name: REDIS_URL, value: "redis://huginn-redis-master.default.svc:6379" }
  - { name: DATABASE_URL, valueFrom: { secretKeyRef: { name: huginn-app, key: uri } } }
  - { name: RABBITMQ_URL, valueFrom: { secretKeyRef: { name: huginn-app, key: url } } }
  - name: PARTITION_ID
    valueFrom:
      fieldRef:
        fieldPath: metadata.annotations['statefulset.kubernetes.io/pod-index']
